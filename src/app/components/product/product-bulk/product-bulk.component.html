<main id="AppFrameMain" class="ui-app-frame__main ">
  <div class="wrapper"
       id="wrapper">
    <div id="body" class="clearfix" data-tg-refresh="body">
      <div class="" id="content">

        <div class="page">


          <header class="ui-title-bar-container ui-title-bar-container--full-width">
            <div class="ui-title-bar">
              <div class="ui-title-bar__navigation">
                <div class="ui-breadcrumbs"><a href="javascript:" routerLink="/products"
                                               class="ui-button ui-button--transparent ui-breadcrumb">
                  <svg class="next-icon next-icon--size-20 next-icon--no-nudge">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#chevron-left-thinner"></use>
                  </svg>
                  <span class="ui-breadcrumb__item">Products</span></a></div>
              </div>
              <div class="ui-title-bar__main-group">
                <div class="ui-title-bar__heading-group"><span class="ui-title-bar__icon"><svg
                  class="next-icon next-icon--color-slate-lighter next-icon--size-20"> <use
                  xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-products"></use> </svg></span>
                  <h1 class="ui-title-bar__title">Bulk editor</h1></div>
              </div>
            </div>
            <div class="collapsible-header">
              <div class="collapsible-header__heading"></div>
            </div>
          </header>
          <form [formGroup]="dataForm" (ngSubmit)="submitForm()">
            <div class="next-grid">
              <div class="next-grid__cell">
                <div class="next-card">
                  <div class="next-card__section">
                    <div class="ui-stack ui-stack--wrap ui-stack--vertical">
                      <label id="next-label--columns" refresh="columns">
                        Currently editing these fields:
                      </label>
                      <div class="next-token-list__wrapper" id="current_columns" refresh="columns">
                        <ul class="next-token-list next-token-list--bulk-editor">
                          <li ngif="headerTable.length" *ngFor="let header of headerTable;let i= index"
                              class="next-token">
                            <span class="next-token__label">{{header.name}}</span>
                            <a (click)="removeHeaderTable(i)" class="next-token__remove">
                            <span class="next-token__remove__icon">
                              <svg class="next-icon next-icon--size-10 next-icon--no-nudge"> <use
                                xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-remove"></use> </svg>
                            </span>
                            </a>
                          </li>
                          <li>
                            <div class="ui-popover__container">
                              <button (click)="isShowBulkAction = !isShowBulkAction"
                                      class="ui-button btn-slim tooltip tooltip-bottom" type="button"
                                      name="button">
                                Add fields
                                <svg class="next-icon next-icon--size-20">
                                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-disclosure"></use>
                                </svg>
                                <div class="tooltip-container">
                                  <span class="tooltip-label">No more editable fields</span>
                                </div>
                              </button>
                              <div [class.ui-popover--is-active]="isShowBulkAction"
                                   class="ui-popover ui-popover--reduced-spacing bulk-edit__popover ui-popover--is-active ui-popover--is-positioned-beneath"
                                   data-popover-horizontally-relative-to-closest=".next-card"
                                   data-popover-css-vertical-margin="13" data-popover-css-horizontal-margin="16"
                                   data-popover-css-max-height="300" data-popover-css-max-width="550" id="ui-popover--2"
                                   aria-labelledby="ui-popover-activator--2" aria-expanded="true" role="dialog"
                                   style="max-width: none; margin-right: 0px; margin-left: 0px; transform-origin: 275px -5px 0px; left: -221px;z-index: 10">
                                <div class="ui-popover__tooltip" style="left: 275px;"></div>
                                <div class="ui-popover__content-wrapper">
                                  <div class="ui-popover__content" style="max-height: 300px; width: 550px;">
                                    <div class="ui-popover__pane">
                                      <div class="ui-popover__section" style="min-width: 350px">
                                        <div
                                          class="next-grid next-grid--no-outside-padding next-grid--vertically-centered">
                                          <div class="next-grid__cell next-grid__cell--quarter">
                                            Attribution
                                          </div>
                                          <div class="next-grid__cell next-grid__cell--vertically-centered">
                                            <ul class="next-token-list">
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('title') != -1 "
                                                  (click)="checkHeaderTable('title') != -1 ? '' : addHeaderTable('title','Title')"
                                              >
                                                <span class="next-token__label">Title</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('tags') != -1 "
                                                  (click)="checkHeaderTable('tags') != -1 ? '' : addHeaderTable('tags','Tags')"
                                              >
                                                <span class="next-token__label">Tags</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('product_type') != -1 "
                                                  (click)="checkHeaderTable('product_type') != -1 ? '' : addHeaderTable('product_type','Product type')"
                                              >
                                                <span class="next-token__label">Product type</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('vendor') != -1 "
                                                  (click)="checkHeaderTable('vendor') != -1 ? '' : addHeaderTable('vendor','Vendor')"
                                              >
                                                <span class="next-token__label">Vendor</span>
                                              </li>
                                              <!--<li class="next-token next-token&#45;&#45;clickable"-->
                                              <!--[class.next-token&#45;&#45;is-disabled]="checkHeaderTable('template_suffix') != -1 "-->
                                              <!--(click)="checkHeaderTable('template_suffix') != -1 ? '' : addHeaderTable('template_suffix','Template')"-->
                                              <!--&gt;-->
                                              <!--<span class="next-token__label">Template</span>-->
                                              <!--</li>-->

                                            </ul>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="ui-popover__section" style="min-width: 350px">
                                        <div
                                          class="next-grid next-grid--no-outside-padding next-grid--vertically-centered">
                                          <div class="next-grid__cell next-grid__cell--quarter">
                                            Pricing
                                          </div>
                                          <div class="next-grid__cell next-grid__cell--vertically-centered">
                                            <ul class="next-token-list">
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('price') != -1 "
                                                  (click)="checkHeaderTable('price') != -1 ? '' : addHeaderTable('price','Price')"
                                              >
                                                <span class="next-token__label">Price</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('compare_at_price') != -1 "
                                                  (click)="checkHeaderTable('compare_at_price') != -1 ? '' : addHeaderTable('compare_at_price','Compare at price')"
                                              >
                                                <span class="next-token__label">Compare at price</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('taxable') != -1 "
                                                  (click)="checkHeaderTable('taxable') != -1 ? '' : addHeaderTable('taxable','Charge taxes')"
                                              >
                                                <span class="next-token__label">Charge taxes</span>
                                              </li>
                                            </ul>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="ui-popover__section" style="min-width: 350px">
                                        <div
                                          class="next-grid next-grid--no-outside-padding next-grid--vertically-centered">
                                          <div class="next-grid__cell next-grid__cell--quarter">
                                            Inventory
                                          </div>
                                          <div class="next-grid__cell next-grid__cell--vertically-centered">
                                            <ul class="next-token-list">
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('sku') != -1 "
                                                  (click)="checkHeaderTable('sku') != -1 ? '' : addHeaderTable('sku','SKU')"
                                              >
                                                <span class="next-token__label">SKU</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('barcode') != -1 "
                                                  (click)="checkHeaderTable('barcode') != -1 ? '' : addHeaderTable('barcode','Barcode')"
                                              >
                                                <span class="next-token__label">Barcode</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('inventory_quantity') != -1 "
                                                  (click)="checkHeaderTable('inventory_quantity') != -1 ? '' : addHeaderTable('inventory_quantity','Inventory quantity')"
                                              >
                                                <span class="next-token__label">Inventory quantity</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('inventory_policy') != -1 "
                                                  (click)="checkHeaderTable('inventory_policy') != -1 ? '' : addHeaderTable('inventory_policy','Allow overselling')"
                                              >
                                                <span class="next-token__label">Allow overselling</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('inventory_management') != -1 "
                                                  (click)="checkHeaderTable('inventory_management') != -1 ? '' : addHeaderTable('inventory_management','Inventory tracking')"
                                              >
                                                <span class="next-token__label">Inventory tracking</span>
                                              </li>
                                            </ul>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="ui-popover__section" style="min-width: 350px">
                                        <div
                                          class="next-grid next-grid--no-outside-padding next-grid--vertically-centered">
                                          <div class="next-grid__cell next-grid__cell--quarter">
                                            Shipping
                                          </div>
                                          <div class="next-grid__cell next-grid__cell--vertically-centered">
                                            <ul class="next-token-list">
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('grams') != -1 "
                                                  (click)="checkHeaderTable('grams') != -1 ? '' : addHeaderTable('grams','Weight')"
                                              >
                                                <span class="next-token__label">Weight</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('requires_shipping') != -1 "
                                                  (click)="checkHeaderTable('requires_shipping') != -1 ? '' : addHeaderTable('requires_shipping','Requires shipping')"
                                              >
                                                <span class="next-token__label">Requires shipping</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('metafields_global_harmonized_system_code') != -1 "
                                                  (click)="checkHeaderTable('metafields_global_harmonized_system_code') != -1 ? '' : addHeaderTable('metafields_global_harmonized_system_code','HS tariff code')"
                                              >
                                                <span class="next-token__label">HS tariff code</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('fulfillment_service') != -1 "
                                                  (click)="checkHeaderTable('fulfillment_service') != -1 ? '' : addHeaderTable('fulfillment_service','Fulfillment service')"
                                              >
                                                <span class="next-token__label">Fulfillment service</span>
                                              </li>
                                            </ul>
                                          </div>
                                        </div>
                                      </div>
                                      <div class="ui-popover__section" style="min-width: 350px">
                                        <div
                                          class="next-grid next-grid--no-outside-padding next-grid--vertically-centered">
                                          <div class="next-grid__cell next-grid__cell--quarter">
                                            Seo
                                          </div>
                                          <div class="next-grid__cell next-grid__cell--vertically-centered">
                                            <ul class="next-token-list">
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('metafield_title') != -1 "
                                                  (click)="checkHeaderTable('metafield_title') != -1 ? '' : addHeaderTable('metafield_title','Page title')"
                                              >
                                                <span class="next-token__label">Page title</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('metafield_description') != -1 "
                                                  (click)="checkHeaderTable('metafield_description') != -1 ? '' : addHeaderTable('metafield_description','Meta description')"
                                              >
                                                <span class="next-token__label">Meta description</span>
                                              </li>
                                              <li class="next-token next-token--clickable"
                                                  [class.next-token--is-disabled]="checkHeaderTable('handle') != -1 "
                                                  (click)="checkHeaderTable('handle') != -1 ? '' : addHeaderTable('handle','URL and handle')"
                                              >
                                                <span class="next-token__label">URL and handle</span>
                                              </li>
                                            </ul>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <section class="next-card__section next-card__section--no-padding">
                    <app-alert></app-alert>
                    <div style="overflow: unset" class="spreadsheet__overflow">
                      <div class="spreadsheet__container" id="resource_table" refresh="bulk">
                        <div class="next-card__section next-card__section--no-padding">
                          <div class="spreadsheet" *ngIf="dataForm.controls.products.value.length && headerTable.length"
                               formArrayName="products">
                            <div class="spreadsheet__header-group">
                              <div class="spreadsheet__cell spreadsheet__cell--dirty-indicator"></div>
                              <div class="spreadsheet__cell spreadsheet__cell--image"></div>

                              <div class="spreadsheet__cell spreadsheet__cell--row-title spreadsheet__cell--resizable"
                                   title="Title">
                                Title
                                <span class="spreadsheet__resize-handle"></span>
                              </div>
                              <ng-container *ngFor="let header of headerTable">
                                <div *ngIf="header.col != 'title'"
                                     class="spreadsheet__cell spreadsheet__cell--resizable spreadsheet__cell--type-string"
                                     title="{{header.col}}">
                                  {{header.name}}
                                  <span class="spreadsheet__resize-handle"></span>
                                </div>
                              </ng-container>
                            </div>
                            <div *ngFor="let product of dataForm.controls.products.controls; let i=index "
                                 class="spreadsheet__row-group" [formGroupName]="i">
                              <div class="spreadsheet__row">
                                <div
                                  class="spreadsheet__cell spreadsheet__cell--dirty-indicator spreadsheet__cell--row-title">
                                  <div class="next-spinner next-spinner--is-hidden">
                                    <svg class="next-icon next-icon--size-12">
                                      <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-spinner"></use>
                                    </svg>
                                  </div>
                                </div>
                                <div class="spreadsheet__cell spreadsheet__cell--row-title spreadsheet__cell--image">
                                  <div class="aspect-ratio aspect-ratio--square aspect-ratio--no-visual-container">
                                    <img
                                      title="{{product.get('title').value}}"
                                      class="aspect-ratio__content"
                                      src="{{product.get('image').value.src }}"
                                      alt="{{product.get('title').value}}">
                                  </div>
                                </div>
                                <div tabindex="-1"
                                     class="spreadsheet__cell spreadsheet__cell--selectable product--title spreadsheet__cell--type-string">
                                  <div class="spreadsheet__drag-selection">
                                    <div class="next-input-wrapper">
                                      <input [readonly]="checkHeaderTable('title') != -1"
                                             type="text" [(ngModel)]="product.get('title').value"
                                             formControlName="title"
                                             size="1" class="next-input"></div>
                                  </div>
                                </div>
                                <ng-container *ngFor="let header of headerTable" ngif="header.col != 'title'">
                                  <ng-container [ngSwitch]="header.col">
                                    <div *ngSwitchCase="'tags'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--tags spreadsheet__cell--type-tags"
                                         data-custom-input="true">
                                      <div class="spreadsheet__drag-selection">
                                        <div
                                          class="ui-popover__container ui-popover__container--full-width-container ui-popover--spreadsheet">
                                          <ul *ngIf="product.get('title').value.length"
                                              class="next-token-list js-addtags spreadsheet__tag-list"
                                              spreadsheet-popover-trigger="">
                                            <li *ngFor="let tag of product.get('tags').value" ngif="!_.isUndefined(tag)"
                                                class="next-token next-token--clickable js-tag"><span
                                              class="next-token__label js-tag-text">{{tag}}</span>
                                            </li>
                                          </ul>
                                          <div class="ui-popover ui-popover--align-edge" tabindex="-1"
                                               data-popover-preferred-position="bottom"
                                               data-popover-relative-to-closest=".spreadsheet__container">
                                            <div class="ui-popover__tooltip"></div>
                                            <div class="ui-popover__content-wrapper">
                                              <div class="ui-popover__content">
                                                <div class="ui-popover__pane">
                                                  <div class="ui-popover__section">
                                                    <div class="tokenized">
                                                      <label class="next-label">
                                                        <div class="next-label ">Tags</div>
                                                        <div class="next-token-list__wrapper">
                                                          <ul
                                                            class="next-token-list next-token-list--is-input tagit ui-widget ui-widget-content ui-corner-all"
                                                            tagit="">


                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Basic care</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Basic care">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Cleansing</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Cleansing">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">dasdas</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="dasdas">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Make up</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Make up">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Mask Pack</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Mask Pack">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Peeling</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Peeling">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">sdwqeqweqw</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="sdwqeqweqw">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Skin care</span><a
                                                              class="tagit-close"><span class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Skin care">
                                                            </li>
                                                            <li
                                                              class="tagit-choice ui-widget-content ui-state-default ui-corner-all tagit-choice-editable">
                                                              <span class="tagit-label">Sun care</span><a
                                                              class="tagit-close"><span
                                                              class="text-icon">×</span><span
                                                              class="ui-icon ui-icon-close"></span></a><input
                                                              type="hidden"
                                                              name="product[tags][]"
                                                              class="tagit-hidden-field"
                                                              value="Sun care">
                                                            </li>
                                                            <li class="tagit-new"><span role="status" aria-live="polite"
                                                                                        class="ui-helper-hidden-accessible"></span><input
                                                              type="text"
                                                              class="ui-widget-content ui-autocomplete-input"
                                                              placeholder="" autocomplete="off"></li>
                                                          </ul>
                                                          <div class="tooltip-error attached-to-bottom hide"
                                                          >
                                                            <ul class="error-list">
                                                              <li></li>
                                                            </ul>
                                                          </div>

                                                        </div>
                                                      </label>
                                                      <div class="previous-tags">
                                                        <p class="sb st">Add existing tags:</p>
                                                        <ul class="next-token-list js-addtags">
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="skin-care">
                                                            <span class="next-token__label js-tag-text">Skin care</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="make-up">
                                                            <span class="next-token__label js-tag-text">Make up</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="basic-care">
                                                            <span
                                                              class="next-token__label js-tag-text">Basic care</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="peeling">
                                                            <span class="next-token__label js-tag-text">Peeling</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="mask-pack">
                                                            <span class="next-token__label js-tag-text">Mask Pack</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="cleansing">
                                                            <span class="next-token__label js-tag-text">Cleansing</span>
                                                          </li>
                                                          <li class="next-token next-token--clickable js-tag"
                                                              data-tag="base-make-up">
                                                            <span
                                                              class="next-token__label js-tag-text">Base Make up</span>
                                                          </li>
                                                          <li class="next-token next-token--clickable js-tag"
                                                              data-tag="lip-make-up">
                                                            <span
                                                              class="next-token__label js-tag-text">Lip Make up</span>
                                                          </li>
                                                          <li class="next-token next-token--clickable js-tag"
                                                              data-tag="eye-make-up">
                                                            <span
                                                              class="next-token__label js-tag-text">Eye Make up</span>
                                                          </li>
                                                          <li
                                                            class="next-token next-token--clickable js-tag next-token--is-disabled"
                                                            data-tag="sun-care">
                                                            <span class="next-token__label js-tag-text">Sun care</span>
                                                          </li>
                                                        </ul>
                                                        <a class="show-all-tags plain"
                                                        >Show all tags</a>
                                                      </div>
                                                    </div>

                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'product_type'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--product_type spreadsheet__cell--type-string">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <input type="text"
                                                 [(ngModel)]="product.get(header.col).value"
                                                 formControlName="{{header.col}}"
                                                 id="product_product_type"
                                                 class="next-input">
                                        </div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'vendor'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--vendor spreadsheet__cell--type-string">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <input
                                            type="text" [(ngModel)]="product.get(header.col).value"
                                            formControlName="{{header.col}}" class="next-input"></div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'template_suffix'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--template_suffix spreadsheet__cell--type-select">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <div class="ui-select__wrapper">
                                            <select formControlName="{{header.col}}"
                                                    id="product_template_suffix"
                                                    class="ui-select">
                                              <option [selected]="product.get(header.col).value == ''" value="">
                                                product
                                              </option>
                                            </select>
                                            <svg class="next-icon next-icon--size-16">
                                              <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                   xlink:href="#select-chevron"></use>
                                            </svg>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'metafield_title'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--metafields_global_title_tag spreadsheet__cell--type-string">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <input type="text"
                                                 [(ngModel)]="product.get(header.col).value"
                                                 formControlName="{{header.col}}"
                                                 placeholder="{{product.get(header.col).value}}"
                                                 maxlength="70" size="1" class="next-input">
                                        </div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'metafield_description'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--metafields_global_description_tag spreadsheet__cell--type-text_area">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <textarea
                                            formControlName="{{header.col}}"
                                            placeholder="{{product.get(header.col).value}}"
                                            maxlength="160" expanding="true"
                                            class="ui-text-area ui-text-area--expanding"
                                            style="height: 80px;" [innerHTML]="product.get(header.col).value">
                                          </textarea>
                                        </div>
                                      </div>
                                    </div>
                                    <div *ngSwitchCase="'handle'" tabindex="-1"
                                         class="spreadsheet__cell spreadsheet__cell--selectable product--handle spreadsheet__cell--type-string">
                                      <div class="spreadsheet__drag-selection">
                                        <div class="next-input-wrapper">
                                          <div class="next-input--stylized next-input--has-content">
                                            <span
                                              class="next-input__add-on next-input__add-on--before next-input__add-on--url-base">https://mybeautyfriend.com/products/</span>
                                            <input
                                              type="text"
                                              [(ngModel)]="product.get(header.col).value"
                                              formControlName="{{header.col}}"
                                              id="product_handle"
                                              placeholder="{{product.get(header.col).value}}"
                                              class="next-input next-input--invisible"></div>
                                        </div>
                                      </div>
                                    </div>
                                    <ng-container *ngSwitchCase="'sku'">
                                      <div
                                        *ngIf="product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div tabindex="-1" formArrayName="variants"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--sku spreadsheet__cell--type-string">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <input type="text"
                                                     [(ngModel)]="product.get('variants').value[0].sku"
                                                     formControlName="sku"
                                                     size="1" class="next-input">
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'price'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-money"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--price spreadsheet__cell--type-money">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <div class="next-input--stylized next-input--has-content"><span
                                                class="next-input__add-on next-input__add-on--before">$</span><input
                                                type="text"
                                                [(ngModel)]="product.get('variants').value[0].price"
                                                formControlName="{{header.col}}"
                                                class="next-input next-input--invisible">
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'compare_at_price'">
                                      <div
                                        *ngIf="product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title'; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-money"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--compare_at_price spreadsheet__cell--type-money">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <div class="next-input--stylized"><span
                                                class="next-input__add-on next-input__add-on--before">$</span>
                                                <input
                                                  type="text"
                                                  [(ngModel)]="product.get('variants').value[0].compare_at_price"
                                                  formControlName="{{header.col}}"
                                                  class="next-input next-input--invisible">
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'taxable'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-boolean"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--taxable spreadsheet__cell--type-boolean">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper next-input-wrapper--inline">
                                              <input
                                                class="next-checkbox" type="checkbox"
                                                [(ngModel)]="product.get('variants').value[0].taxable"
                                                formControlName="taxable"
                                                [checked]="product.get('variants').value[0].taxable">

                                              <span
                                                class="next-checkbox--styled"><svg
                                                class="next-icon next-icon--size-10 checkmark"> <use
                                                xmlns:xlink="http://www.w3.org/1999/xlink"
                                                xlink:href="#next-checkmark-thick"></use> </svg>
                                    </span>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'barcode'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--barcode spreadsheet__cell--type-string">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <input type="text"
                                                     [(ngModel)]="product.get('variants').value[0].barcode"
                                                     formControlName="barcode"
                                                     class="next-input">
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'inventory_quantity'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div
                                          class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                          aria-label="Uneditable">—
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'inventory_policy'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--inventory_policy spreadsheet__cell--type-boolean">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper next-input-wrapper--inline">
                                              <input
                                                class="next-checkbox" type="checkbox"
                                                [(ngModel)]="product.get('variants').value[0].inventory_policy"
                                                formControlName="inventory_policy"
                                                [checked]="product.get('variants').value[0].inventory_policy != 0">
                                              <span
                                                class="next-checkbox--styled"><svg
                                                class="next-icon next-icon--size-10 checkmark"> <use
                                                xmlns:xlink="http://www.w3.org/1999/xlink"
                                                xlink:href="#next-checkmark-thick"></use> </svg>
                                            </span>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'inventory_management'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--inventory_management spreadsheet__cell--type-select">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <div class="ui-select__wrapper">
                                                <select
                                                  formControlName="inventory_management"
                                                  class="ui-select">
                                                  <option
                                                    [selected]="product.get('variants').value[0].inventory_management==''"
                                                    value="">Don't track
                                                    inventory
                                                  </option>
                                                  <option
                                                    [selected]="product.get('variants').value[0].inventory_management=='shopify'"
                                                    value="shopify">Shopify
                                                    tracks this product's inventory
                                                  </option>
                                                </select>
                                                <svg class="next-icon next-icon--size-16">
                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                       xlink:href="#select-chevron"></use>
                                                </svg>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'grams'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--weight spreadsheet__cell--type-weight">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <div class="next-field__connected-wrapper">
                                                <input type="text"
                                                       [(ngModel)]="product.get('variants').value[0].grams"
                                                       formControlName="grams"
                                                       class="next-field--connected next-input">
                                                <div
                                                  class="ui-select__wrapper next-field--connected next-field--connected--no-flex next-input--has-content">

                                                  <select formControlName="weight_unit"
                                                          label_hidden="true" class="ui-select">
                                                    <option
                                                      [selected]="product.get('variants').value[0].weight_unit=='lb'"
                                                      value="lb">
                                                      lb
                                                    </option>
                                                    <option
                                                      [selected]="product.get('variants').value[0].weight_unit=='oz'"
                                                      value="oz">
                                                      oz
                                                    </option>
                                                    <option
                                                      [selected]="product.get('variants').value[0].weight_unit=='kg'"
                                                      value="kg">
                                                      kg
                                                    </option>
                                                    <option
                                                      [selected]="product.get('variants').value[0].weight_unit=='g'"
                                                      value="g">g
                                                    </option>
                                                  </select>
                                                  <svg class="next-icon next-icon--size-16">
                                                    <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                         xlink:href="#select-chevron"></use>
                                                  </svg>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'requires_shipping'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--requires_shipping spreadsheet__cell--type-boolean">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper next-input-wrapper--inline">
                                              <input
                                                class="next-checkbox" type="checkbox"
                                                [checked]="product.get('variants').value[0].requires_shipping"
                                                [(ngModel)]="product.get('variants').value[0].requires_shipping"
                                                formControlName="requires_shipping">
                                              <span
                                                class="next-checkbox--styled"><svg
                                                class="next-icon next-icon--size-10 checkmark"> <use
                                                xmlns:xlink="http://www.w3.org/1999/xlink"
                                                xlink:href="#next-checkmark-thick"></use> </svg></span>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'metafields_global_harmonized_system_code'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--metafields_global_harmonized_system_code spreadsheet__cell--type-string">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <input type="text"
                                                     [(ngModel)]="product.get('variants').value[0].metafields_global_harmonized_system_code"
                                                     formControlName="metafields_global_harmonized_system_code"
                                                     class="next-input">
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="'fulfillment_service'">
                                      <div
                                        *ngIf=" product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title' ; else variantBlock"
                                        class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                        aria-label="Uneditable">—
                                      </div>
                                      <ng-template #variantBlock>
                                        <div formArrayName="variants" tabindex="-1"
                                             class="spreadsheet__cell spreadsheet__cell--selectable productvariant--fulfillment_service spreadsheet__cell--type-select">
                                          <div class="spreadsheet__drag-selection" [formGroupName]="0">
                                            <div class="next-input-wrapper">
                                              <div class="ui-select__wrapper next-input--has-content">
                                                <select
                                                  formControlName="fulfillment_service" class="ui-select">
                                                  <option
                                                    [selected]="product.get('variants').value[0].fulfillment_service=='manual'"
                                                    value="manual">Manual
                                                  </option>
                                                </select>
                                                <svg class="next-icon next-icon--size-16">
                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                       xlink:href="#select-chevron"></use>
                                                </svg>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </ng-template>
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
                              </div>
                              <ng-container
                                *ngIf="product.get('variants').value.length && product.get('variants').value[0].option1 != 'Default Title' && product.get('variants').value[0].title != 'Default Title'"
                                formArrayName="variants">
                                <div *ngFor="let vari of product.controls['variants'].controls; let x=index"
                                     class="spreadsheet__row" [formGroupName]="x">
                                  <div
                                    class="spreadsheet__cell spreadsheet__cell--dirty-indicator spreadsheet__cell--row-title">
                                    <div class="next-spinner next-spinner--is-hidden">
                                      <svg class="next-icon next-icon--size-12">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                             xlink:href="#next-spinner"></use>
                                      </svg>
                                    </div>
                                  </div>
                                  <div
                                    class="spreadsheet__cell spreadsheet__cell--row-title spreadsheet__cell--image"></div>
                                  <div
                                    class="spreadsheet__cell spreadsheet__cell--row-title spreadsheet__cell--row-subtitle productvariant--title">
                                          <span
                                            class="variant-option-value option-1">{{vari.get('option1').value}}</span>
                                    <span *ngIf="vari.get('option2').value != ''" class="type--subdued"> • </span>
                                    <span
                                      class="variant-option-value option-2">{{vari.get('option2').value}}</span>
                                    <span *ngIf="vari.get('option3').value != ''" class="type--subdued"> • </span>
                                    <span
                                      class="variant-option-value option-3">{{vari.get('option3').value}}</span>
                                  </div>
                                  <ng-container *ngFor="let header of headerTable">
                                    <ng-container [ngSwitch]="header.col">
                                      <div *ngSwitchCase="'tags'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-tags"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'product_type'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'vendor'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'template_suffix'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-select"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'metafield_title'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-publishing"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'metafield_description'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-publishing"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'handle'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-string"
                                           aria-label="Uneditable">—
                                      </div>

                                      <div *ngSwitchCase="'sku'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--sku spreadsheet__cell--type-string">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <input type="text"
                                                   [(ngModel)]="vari.get(header.col).value"
                                                   formControlName="{{header.col}}"
                                                   size="1" class="next-input">
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'price'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--price spreadsheet__cell--type-money">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <div class="next-input--stylized next-input--has-content"><span
                                              class="next-input__add-on next-input__add-on--before">$</span><input
                                              type="text"
                                              [(ngModel)]="vari.get(header.col).value"
                                              formControlName="{{header.col}}"
                                              class="next-input next-input--invisible">
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'compare_at_price'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--compare_at_price spreadsheet__cell--type-money">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <div class="next-input--stylized"><span
                                              class="next-input__add-on next-input__add-on--before">$</span>
                                              <input
                                                type="text"
                                                [(ngModel)]="vari.get(header.col).value"
                                                formControlName="{{header.col}}"
                                                class="next-input next-input--invisible">
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'taxable'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--taxable spreadsheet__cell--type-boolean">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper next-input-wrapper--inline">
                                            <input
                                              class="next-checkbox" type="checkbox"
                                              [(ngModel)]="vari.get(header.col).value"
                                              formControlName="{{header.col}}" [checked]="vari.get(header.col).value">

                                            <span
                                              class="next-checkbox--styled"><svg
                                              class="next-icon next-icon--size-10 checkmark"> <use
                                              xmlns:xlink="http://www.w3.org/1999/xlink"
                                              xlink:href="#next-checkmark-thick"></use> </svg>
                                          </span>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'barcode'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--barcode spreadsheet__cell--type-string">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <input type="text"
                                                   [(ngModel)]="vari.get(header.col).value"
                                                   formControlName="{{header.col}}"
                                                   class="next-input">
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'inventory_quantity'"
                                           class="spreadsheet__cell spreadsheet__cell--uneditable spreadsheet__cell--type-inventory_adjustment"
                                           aria-label="Uneditable">—
                                      </div>
                                      <div *ngSwitchCase="'inventory_policy'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--inventory_policy spreadsheet__cell--type-boolean">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper next-input-wrapper--inline">
                                            <input
                                              class="next-checkbox" type="checkbox"
                                              [(ngModel)]="vari.get(header.col).value"
                                              formControlName="{{header.col}}"
                                              [checked]="vari.get(header.col).value != 0">
                                            <span
                                              class="next-checkbox--styled"><svg
                                              class="next-icon next-icon--size-10 checkmark"> <use
                                              xmlns:xlink="http://www.w3.org/1999/xlink"
                                              xlink:href="#next-checkmark-thick"></use> </svg>
                                            </span>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'inventory_management'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--inventory_management spreadsheet__cell--type-select">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <div class="ui-select__wrapper">
                                              <select
                                                formControlName="{{header.col}}"
                                                class="ui-select">
                                                <option [selected]="vari.get(header.col).value==''" value="">Don't track
                                                  inventory
                                                </option>
                                                <option [selected]="vari.get(header.col).value=='shopify'"
                                                        value="shopify">Shopify
                                                  tracks this product's inventory
                                                </option>
                                              </select>
                                              <svg class="next-icon next-icon--size-16">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                     xlink:href="#select-chevron"></use>
                                              </svg>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'grams'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--weight spreadsheet__cell--type-weight">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <div class="next-field__connected-wrapper">
                                              <input type="text"
                                                     [(ngModel)]="vari.grams"
                                                     formControlName="grams"
                                                     id="product_variant_weight"

                                                     class="next-field--connected next-input">
                                              <div
                                                class="ui-select__wrapper next-field--connected next-field--connected--no-flex next-input--has-content">

                                                <select formControlName="weight_unit"
                                                        id="product_variant_weight_unit"
                                                        label_hidden="true" class="ui-select">
                                                  <option [selected]="vari.get('weight_unit').value=='lb'" value="lb">
                                                    lb
                                                  </option>
                                                  <option [selected]="vari.get('weight_unit').value=='oz'" value="oz">
                                                    oz
                                                  </option>
                                                  <option [selected]="vari.get('weight_unit').value=='kg'" value="kg">
                                                    kg
                                                  </option>
                                                  <option [selected]="vari.get('weight_unit').value=='g'" value="g">g
                                                  </option>
                                                </select>
                                                <svg class="next-icon next-icon--size-16">
                                                  <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                       xlink:href="#select-chevron"></use>
                                                </svg>
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'requires_shipping'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--requires_shipping spreadsheet__cell--type-boolean">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper next-input-wrapper--inline">
                                            <input
                                              class="next-checkbox" type="checkbox"
                                              [checked]="vari.get(header.col).value"
                                              [(ngModel)]="vari.get(header.col).value"
                                              formControlName="{{header.col}}">
                                            <span
                                              class="next-checkbox--styled"><svg
                                              class="next-icon next-icon--size-10 checkmark"> <use
                                              xmlns:xlink="http://www.w3.org/1999/xlink"
                                              xlink:href="#next-checkmark-thick"></use> </svg></span>
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'metafields_global_harmonized_system_code'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--metafields_global_harmonized_system_code spreadsheet__cell--type-string">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <input type="text"
                                                   [(ngModel)]="vari.get(header.col).value"
                                                   formControlName="{{header.col}}"
                                                   class="next-input">
                                          </div>
                                        </div>
                                      </div>
                                      <div *ngSwitchCase="'fulfillment_service'" tabindex="-1"
                                           class="spreadsheet__cell spreadsheet__cell--selectable productvariant--fulfillment_service spreadsheet__cell--type-select">
                                        <div class="spreadsheet__drag-selection">
                                          <div class="next-input-wrapper">
                                            <div class="ui-select__wrapper next-input--has-content">
                                              <select
                                                formControlName="{{header.col}}"
                                                id="product_variant_fulfillment_service" class="ui-select">
                                                <option [selected]="vari.get(header.col).value=='manual'"
                                                        value="manual">Manual
                                                </option>
                                              </select>
                                              <svg class="next-icon next-icon--size-16">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink"
                                                     xlink:href="#select-chevron"></use>
                                              </svg>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </ng-container>
                                  </ng-container>
                                </div>
                              </ng-container>
                            </div>
                          </div>
                        </div>
                        <div class="next-card__section">
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </div>
            <div class="ui-page-actions">
              <div class="ui-page-actions__container">
                <div class="ui-page-actions__actions ui-page-actions__actions--primary">
                  <div class="ui-page-actions__button-group">
                    <a class="btn" data-allow-default="1" routerLink="/products">Cancel</a>
                    <button class="btn js-btn-primary js-btn-loadable btn-primary has-loading" name="button"
                            type="submit">Save
                      product
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </form>
          <div class="ui-footer-help">
            <div class="ui-footer-help__content">
              <div class="ui-footer-help__icon">
                <svg class="next-icon next-icon--size-24 next-icon--no-nudge" role="img"
                     aria-labelledby="next-help-circle-5e107e7128f049fe34a958783b692e58-title"><title
                  id="next-help-circle-5e107e7128f049fe34a958783b692e58-title">Help</title>
                  <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#next-help-circle"></use>
                </svg>
              </div>
              <div>
                <p>
                  Use your arrow keys to switch between cells.<br>
                  Hold shift to select multiple cells.
                </p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</main>
